<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.css"
    />
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@splidejs/splide@2.4.21/dist/css/themes/splide-skyblue.min.css"
    />

    <link rel="stylesheet" href="/css/bootstrap-utils/opacity.css" />
    <link rel="stylesheet" href="/css/index.css" />
    <link rel="stylesheet" href="/css/anime.css" />
    <title>FPTPlay-Clone</title>
  </head>
  <body>
    <%- include('../../partials/header'); %>

    <div class="container opacity-0">
      <div class="row">
        <div class="col-12 anime-slider">
          <div class="splide my-4">
            <div class="splide__track">
              <ul class="splide__list">
                <% anime.slides.forEach(slide => { %>
                <li class="splide__slide">
                  <div class="splide__slide__container text-white splide__item">
                    <a href="/anime/watch/<%= slide.id %>">
                      <img src="<%= slide.thumbnail %>" class="w-100" />
                      <div class="anime-info w-100 w-100 p-4">
                        <div class="anime-name fs-2"><%= slide.name %></div>
                        <div class="anime-duration text-muted">
                          <%= slide.duration %>
                        </div>
                        <div class="anime-description">
                          <%= slide.description %>
                        </div>
                      </div>
                    </a>
                  </div>
                </li>
                <% }) %>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-12 anime-list">
          <ul
            class="nav nav-pills justify-content-center my-4"
            id="pills-tab"
            role="tablist"
          >
            <li class="nav-item">
              <a
                class="nav-link active"
                id="pills-home-tab"
                data-bs-toggle="pill"
                href="#anime-total"
                role="tab"
                aria-controls="pills-home"
                aria-selected="false"
                >Tất cả</a
              >
            </li>

            <li class="nav-item">
              <a
                class="nav-link"
                id="pills-home-tab"
                data-bs-toggle="pill"
                href="#anime-trending"
                role="tab"
                aria-controls="pills-home"
                aria-selected="false"
                >Xu hướng</a
              >
            </li>

            <li class="nav-item">
              <a
                class="nav-link"
                id="pills-home-tab"
                data-bs-toggle="pill"
                href="#anime-winter2021"
                role="tab"
                aria-controls="pills-home"
                aria-selected="false"
                >Mùa đông 2021</a
              >
            </li>

            <li class="nav-item">
              <a
                class="nav-link"
                id="pills-home-tab"
                data-bs-toggle="pill"
                href="#anime-action"
                role="tab"
                aria-controls="pills-home"
                aria-selected="false"
                >Hành động</a
              >
            </li>

            <li class="nav-item">
              <a
                class="nav-link"
                id="pills-home-tab"
                data-bs-toggle="pill"
                href="#anime-scifi"
                role="tab"
                aria-controls="pills-home"
                aria-selected="false"
                >Viễn tưởng</a
              >
            </li>

            <li class="nav-item">
              <a
                class="nav-link"
                id="pills-home-tab"
                data-bs-toggle="pill"
                href="#anime-romantic"
                role="tab"
                aria-controls="pills-home"
                aria-selected="false"
                >Tình cảm</a
              >
            </li>

            <li class="nav-item">
              <a
                class="nav-link"
                id="pills-home-tab"
                data-bs-toggle="pill"
                href="#anime-chinese"
                role="tab"
                aria-controls="pills-home"
                aria-selected="false"
                >Hoạt hình Trung Quốc</a
              >
            </li>
          </ul>
          <div class="tab-content" id="pills-tabContent">
            <div
              class="tab-pane fade show active"
              id="anime-total"
              role="tabpanel"
            >
              <div class="container">
                <div class="row"></div>
              </div>
            </div>

            <div
              class="tab-pane fade"
              id="anime-trending"
              role="tabpanel"
              aria-labelledby="pills-profile-tab"
            >
              <div class="container">
                <div class="row"></div>
              </div>
            </div>

            <div
              class="tab-pane fade"
              id="anime-winter2021"
              role="tabpanel"
              aria-labelledby="pills-profile-tab"
            >
              <div class="container">
                <div class="row"></div>
              </div>
            </div>

            <div
              class="tab-pane fade"
              id="anime-action"
              role="tabpanel"
              aria-labelledby="pills-profile-tab"
            >
              <div class="container">
                <div class="row"></div>
              </div>
            </div>

            <div
              class="tab-pane fade"
              id="anime-scifi"
              role="tabpanel"
              aria-labelledby="pills-profile-tab"
            >
              <div class="container">
                <div class="row"></div>
              </div>
            </div>

            <div
              class="tab-pane fade"
              id="anime-romantic"
              role="tabpanel"
              aria-labelledby="pills-profile-tab"
            >
              <div class="container">
                <div class="row"></div>
              </div>
            </div>

            <div
              class="tab-pane fade"
              id="anime-chinese"
              role="tabpanel"
              aria-labelledby="pills-profile-tab"
            >
              <div class="container">
                <div class="row"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
      crossorigin="anonymous"
    ></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"
      integrity="sha512-bZS47S7sPOxkjU/4Bt0zrhEtWx0y0CRkhEp8IckzK+ltifIIE9EMIMTuT/mEzoIMewUINruDBIR/jJnbguonqQ=="
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@latest/dist/js/splide.min.js"></script>

    <script src="/js/fptplay.js"></script>
    <script src="/js/models/Anime.js"></script>
    <script src="/js/utils/index.js"></script>

    <script>
      new Splide(".splide", {
        rewind: true,
        autoplay: true,
        lazyLoad: "nearby",
      }).mount();

      (async () => {
        const structures = [
          "trending",
          "total",
          "winter2021",
          "action",
          "scifi",
          "romantic",
          "chinese",
        ];

        const promiseAnimeList = structures.map((structure) =>
          Anime.getList(structure)
        );

        const animeList = await Promise.all(promiseAnimeList);

        animeList.forEach((list, index) => {
          const selector = `#anime-${structures[index]} .row`;
          const $container = $(selector);

          list.forEach((anime) => {
            $container.append(`
            <div class="col-xxl-2 col-lg-3 col-sm-6 col-md-4 my-2">
              <div class="card anime-item">
                <a href="/anime/watch/${anime._id}">
                  <img
                    src="${anime.standing_thumb}"
                    class="card-img-top thumbnail"
                  />
                  <div class="card-body text-white">
                    <p class="card-text">
                      ${textAbstract(anime.title_vie, 35)}
                    </p>
                  </div>
                </a>
              </div>
            </div>`);
          });
        });

        $(".container").fadeTo(1000, 1);
      })();
    </script>
  </body>
</html>
